const jwt = require('jsonwebtoken');
require('dotenv').config();

const secret = process.env.ACCESS_TOKEN_SECRET || "ABCDEFGHIJKLMNOPQRSTUVWXYZ133";

module.exports = ((req,res,next)=>{
    const token = req.headers.authorization || req.headers.authorization;
    console.log(token);
    if(!token){
        return res.send("Authentication Denied");
    }
    jwt.verify(token,secret,(err,decoded)=>{
        if(err) return res.status(403).json({message:"Invalid Token!",details:err});
        req.user = decoded.useraname;
        next();
    })
})